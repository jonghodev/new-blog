---
title: JPA - 상속 관계 매핑
date: 2020-10-12 15:10:77
category: java
draft: false
---

## 용어

정규화: 중복을 줄이고, 무결성을 향상시킨다.

## 조인전략

모든 객체를 테이블로 만들어, 자식 테이블이 부모 테이블의 기본키를 받아 기본 키 + 외래 키로 사용한다.
따라서 조회할 때 조인을 자주 사용한다. 또한 타입을 구분하는 컬럼을 추가해야 한다.

장점

- 테이블이 정규화된다.
- 외래 키 참조 무결성 제약조건을 활용할 수 있다.
- 저장공간을 효율적으로 사용한다.

단점

- 조회할 때 조인이 많이 사용되므로 성능이 저하될 수 있다.
- 조회 쿼리가 복잡하다.
- 데이터를 등록할 `INSERT SQL` 을 두 번 실행한다.

## 단일 테이블 전략

단순히 테이블 하나만 사용하며 type 만 주어서 관리하고, 각각의 자식 컬럼들은 당연히 `null` 을 허용해야 한다.

장점

- 조인이 필요없으므로 일반적으로 조회 성능이 빠르다.
- 조회 쿼리가 단순하다.

단점

- 자식 엔티티가 매핑된 컬럼은 모두 `null` 을 허용해야 한다.
- 테이블이 커질 수 있다. 따라서 상황에 따라서 조회 성능이 느려질 수 있다.

특징

- 구분 컬럼 `@DiscriminatorColumn` 을 꼭 사용해야 한다. 을 꼭 설정해야 한다.
- `@DiscriminatorValue` 를 지정하지 않으면 기본으로 엔티티 이름을 사용한다.

## 구현 클래스마다 테이블 전략

자식 엔티티마다 테이블을 만들기 때문에 일반적으로 추천되지 않는다.

단점

- 여러 자식 테이블 함께 UNION 을 사용해야 하기 때문에 조회할 때 성능이 느리다.

## References

[자바 ORM 표준 JPA 프로그래밍](https://www.aladin.co.kr/shop/wproduct.aspx?itemid=62681446)
